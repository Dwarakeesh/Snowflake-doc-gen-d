CREATE OR REPLACE PROCEDURE AI_FEATURE_HUB.PROCESS_PAYMENT(account_id STRING,amount NUMBER,currency STRING) RETURNS VARIANT LANGUAGE SQL AS $$ BEGIN INSERT INTO AI_FEATURE_HUB.PAYMENTS(PAYMENT_ID,PAYMENT_TIMESTAMP,ACCOUNT_ID,AMOUNT,CURRENCY,STATUS) VALUES(UUID_STRING(),CURRENT_TIMESTAMP(),:account_id,:amount,:currency,'success'); CALL AI_FEATURE_HUB.POST_BILLING_EVENT(:account_id,'payment',:amount,:currency,null); RETURN 'ok'; END; $$;