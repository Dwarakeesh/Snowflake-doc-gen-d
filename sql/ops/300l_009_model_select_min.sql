CREATE OR REPLACE PROCEDURE AI_FEATURE_HUB.SELECT_MODEL_FOR_TASK(task_type STRING) RETURNS VARIANT LANGUAGE SQL AS $$ SELECT MODEL_ID FROM AI_FEATURE_HUB.MODEL_REGISTRY WHERE IS_ACTIVE=TRUE AND MODEL_TYPE=CASE WHEN :1 IN ('embed','similarity') THEN 'embedding' WHEN :1 IN ('clause','generate') THEN 'generation' ELSE 'generation' END LIMIT 1; $$;GRANT EXECUTE ON PROCEDURE AI_FEATURE_HUB.SELECT_MODEL_FOR_TASK TO ROLE YOUR_RUN_ROLE;